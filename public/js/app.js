const hamburguer=document.querySelector(".hamburguer"),email={nombre:"",email:"",telefono:""},emailNewsletter={email:""},formHeader=document.querySelector("#formHeader"),inputName=document.querySelector("#name"),inputEmail=document.querySelector("#email"),inputTel=document.querySelector("#tel"),formNewsletter=document.querySelector("#formNewsletter"),inputEmailNewsletter=document.querySelector("#emailNews");function eventListeners(){hamburguer.addEventListener("click",openCloseNav),inputName.addEventListener("input",validar),inputEmail.addEventListener("input",validar),inputTel.addEventListener("input",validar),inputEmailNewsletter.addEventListener("input",validar),formHeader.addEventListener("submit",sendEmail),formNewsletter.addEventListener("submit",sendEmail)}function openCloseNav(){const e=document.querySelector(".nav");e.classList.toggle("nav--activo"),closeNavOnClick(e)}function closeNavOnClick(e){document.querySelectorAll(".nav__link").forEach((t,r)=>{t.addEventListener("click",t=>{t.preventDefault();document.querySelector(t.target.attributes.href.value).scrollIntoView({behavior:"smooth"});"A"===t.target.tagName&&e.classList.remove("nav--activo")})}),window.addEventListener("click",t=>{const r=t.target.parentElement;e.classList.contains("nav--activo")&&r!==hamburguer&&e.classList.remove("nav--activo")})}function validar(e){const t=e.target,r=t.parentElement,i=t.id,l=t.name,n=t.value.trim().toLowerCase();return""===n&&"emailNews"!==i?(showAlert(`El ${l} es obligatorio`,r),email[l]="",void checkEmail()):"email"!==i||isValidEmail(n)?"telefono"!==i||isValidTel(n)?"emailNews"!==i||isValidEmail(n)?(cleanAlert(r),fillObjects(r,l,n),checkEmail(),void checkEmailNewsletter()):(showAlert("El email es invalido",r),emailNewsletter[l]="",void checkEmailNewsletter()):(showAlert("El teléfono es inválido",r),email[l]="",void checkEmail()):(showAlert("El email es inválido",r),email[l]="",void checkEmail())}function showAlert(e,t){cleanAlert(t);const r=t.querySelector(".form__field");r.classList.add("form__field--error"),r.placeholder=e}function cleanAlert(e){const t=e.querySelector(".form__field--error");t&&(t.classList.remove("form__field--error"),t.placeholder="Ingresa tu "+t.name)}function isValidEmail(e){return/^\w+([.-_+]?\w+)*@\w+([.-]?\w+)*(\.\w{2,10})+$/.test(e)}function isValidTel(e){return/^(\+52|0052|52)?[ -]*[ -]*([0-9][ -]*){10}/.test(e)}function fillObjects(e,t,r){e.parentElement===formHeader&&(email[t]=r),e.parentElement===formNewsletter&&(emailNewsletter[t]=r)}function checkEmail(){const e=document.querySelector("#btnSubmit");Object.values(email).includes("")?e.disabled=!0:e.disabled=!1}function checkEmailNewsletter(){const e=document.querySelector("#btnSubscribe");Object.values(emailNewsletter).includes("")?e.disabled=!0:e.disabled=!1}function sendEmail(e){e.preventDefault();const t=e.target;if(t===formHeader){const e=document.querySelector("#spinner");return e.classList.add("form__spinner--activo"),e.classList.remove("form__spinner"),void setTimeout(()=>{e.classList.remove("form__spinner--activo"),e.classList.add("form__spinner"),resetForm(t);const r=document.createElement("P");r.classList.add("form__exito"),r.textContent="Mensaje envíado exitosamente",formHeader.appendChild(r),setTimeout(()=>{r.remove()},2e3)},3e3)}if(t===formNewsletter){const e=document.querySelector("#spinnerNews");return e.classList.add("form__spinner--activo"),e.classList.remove("form__spinner"),void setTimeout(()=>{e.classList.remove("form__spinner--activo"),e.classList.add("form__spinner"),resetForm(t);const r=document.createElement("P");r.classList.add("form__exito"),r.classList.add("form__exito--newsletter"),r.textContent="Gracias por suscribirte",formNewsletter.appendChild(r),setTimeout(()=>{r.remove()},2e3)},3e3)}}function resetForm(e){return e===formHeader?(email.nombre="",email.email="",email.telefono="",formHeader.reset(),void checkEmail()):e===formNewsletter?(emailNewsletter.email="",formNewsletter.reset(),void checkEmailNewsletter()):void 0}document.addEventListener("DOMContentLoaded",eventListeners);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJoYW1idXJndWVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZW1haWwiLCJub21icmUiLCJ0ZWxlZm9ubyIsImVtYWlsTmV3c2xldHRlciIsImZvcm1IZWFkZXIiLCJpbnB1dE5hbWUiLCJpbnB1dEVtYWlsIiwiaW5wdXRUZWwiLCJmb3JtTmV3c2xldHRlciIsImlucHV0RW1haWxOZXdzbGV0dGVyIiwiZXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwib3BlbkNsb3NlTmF2IiwidmFsaWRhciIsInNlbmRFbWFpbCIsIm5hdiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImNsb3NlTmF2T25DbGljayIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZWFjaExpbmsiLCJpbmRleCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInRhcmdldCIsImF0dHJpYnV0ZXMiLCJocmVmIiwidmFsdWUiLCJzY3JvbGxJbnRvVmlldyIsImJlaGF2aW9yIiwidGFnTmFtZSIsInJlbW92ZSIsIndpbmRvdyIsInJlZmVyZW5jaWEiLCJwYXJlbnRFbGVtZW50IiwiY29udGFpbnMiLCJpbnB1dCIsInJlZmVyZW5jZSIsImZpZWxkSWQiLCJpZCIsImZpZWxkTmFtZSIsIm5hbWUiLCJmaWVsZFZhbHVlIiwidHJpbSIsInRvTG93ZXJDYXNlIiwic2hvd0FsZXJ0IiwiY2hlY2tFbWFpbCIsImlzVmFsaWRFbWFpbCIsImlzVmFsaWRUZWwiLCJjbGVhbkFsZXJ0IiwiZmlsbE9iamVjdHMiLCJjaGVja0VtYWlsTmV3c2xldHRlciIsIm1lbnNhamUiLCJlcnJvciIsImFkZCIsInBsYWNlaG9sZGVyIiwiaXNBY3RpdmVBbGVydCIsInRlc3QiLCJ0ZWwiLCJidG5TdWJtaXQiLCJPYmplY3QiLCJ2YWx1ZXMiLCJpbmNsdWRlcyIsImRpc2FibGVkIiwiYnRuU3Vic2NyaWJlIiwic3Bpbm5lciIsInNldFRpbWVvdXQiLCJyZXNldEZvcm0iLCJhbGVydGFFeGl0byIsImNyZWF0ZUVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImFwcGVuZENoaWxkIiwic3Bpbm5lck5ld3MiLCJyZXNldCJdLCJtYXBwaW5ncyI6IkFBQ0EsTUFBTUEsV0FBYUMsU0FBU0MsY0FBYyxlQUlwQ0MsTUFBUSxDQUNaQyxPQUFRLEdBQ1JELE1BQU8sR0FDUEUsU0FBVSxJQUdOQyxnQkFBa0IsQ0FDdEJILE1BQU8sSUFHSEksV0FBYU4sU0FBU0MsY0FBYyxlQUNwQ00sVUFBWVAsU0FBU0MsY0FBYyxTQUNuQ08sV0FBYVIsU0FBU0MsY0FBYyxVQUNwQ1EsU0FBV1QsU0FBU0MsY0FBYyxRQUNsQ1MsZUFBaUJWLFNBQVNDLGNBQWMsbUJBQ3hDVSxxQkFBdUJYLFNBQVNDLGNBQWMsY0FNcEQsU0FBU1csaUJBRVBiLFdBQVdjLGlCQUFpQixRQUFTQyxjQUdyQ1AsVUFBVU0saUJBQWlCLFFBQVNFLFNBQ3BDUCxXQUFXSyxpQkFBaUIsUUFBU0UsU0FDckNOLFNBQVNJLGlCQUFpQixRQUFTRSxTQUNuQ0oscUJBQXFCRSxpQkFBaUIsUUFBU0UsU0FDL0NULFdBQVdPLGlCQUFpQixTQUFVRyxXQUN0Q04sZUFBZUcsaUJBQWlCLFNBQVVHLFdBUzVDLFNBQVNGLGVBQ1AsTUFBTUcsRUFBTWpCLFNBQVNDLGNBQWMsUUFFbkNnQixFQUFJQyxVQUFVQyxPQUFPLGVBRXJCQyxnQkFBZ0JILEdBUWxCLFNBQVNHLGdCQUFnQkgsR0FDTmpCLFNBQVNxQixpQkFBaUIsY0FFbENDLFFBQVEsQ0FBQ0MsRUFBVUMsS0FDMUJELEVBQVNWLGlCQUFpQixRQUFVWSxJQUNsQ0EsRUFBRUMsaUJBR2MxQixTQUFTQyxjQUFjd0IsRUFBRUUsT0FBT0MsV0FBV0MsS0FBS0MsT0FDeERDLGVBQWUsQ0FBRUMsU0FBVSxXQUdwQixNQUNYUCxFQUFFRSxPQUFPTSxTQUNYaEIsRUFBSUMsVUFBVWdCLE9BQU8sbUJBTTNCQyxPQUFPdEIsaUJBQWlCLFFBQVVZLElBRWhDLE1BQU1XLEVBQWFYLEVBQUVFLE9BQU9VLGNBTXhCcEIs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LEVBQWN2RSxTQUFTd0UsY0FBYyxLQUMzQ0QsRUFBWXJELFVBQVV1QyxJQUFJLGVBQzFCYyxFQUFZckQsVUFBVXVDLElBQUksMkJBQzFCYyxFQUFZRSxZQUFjLDBCQUUxQi9ELGVBQWVnRSxZQUFZSCxHQUczQkYsV0FBVyxLQUNURSxFQUFZckMsVUFDWCxNQUNGLE1BYVAsU0FBU29DLFVBQVUvQixHQUNqQixPQUFJQSxJQUFVakMsWUFFWkosTUFBTUMsT0FBUyxHQUNmRCxNQUFNQSxNQUFRLEdBQ2RBLE1BQU1FLFNBQVcsR0FHakJFLFdBQVdzRSxhQUdYM0IsY0FLRVYsSUFBVTdCLGdCQUVaTCxnQkFBZ0JILE1BQVEsR0FHeEJRLGVBQWVrRSxhQUdmdEIsNkJBUkYsRUE3VUZ0RCxTQUFTYSxpQkFBaUIsbUJBQW9CRCIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBWYXJpYWJsZXMgTmF2XHJcbmNvbnN0IGhhbWJ1cmd1ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuaGFtYnVyZ3VlcmApO1xyXG5cclxuLy8gVmFyaWFibGVzIGZvcm11bGFyaW9cclxuXHJcbmNvbnN0IGVtYWlsID0ge1xyXG4gIG5vbWJyZTogYGAsXHJcbiAgZW1haWw6IGBgLFxyXG4gIHRlbGVmb25vOiBgYCxcclxufTtcclxuXHJcbmNvbnN0IGVtYWlsTmV3c2xldHRlciA9IHtcclxuICBlbWFpbDogYGAsXHJcbn07XHJcblxyXG5jb25zdCBmb3JtSGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2Zvcm1IZWFkZXJgKTtcclxuY29uc3QgaW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI25hbWVgKTtcclxuY29uc3QgaW5wdXRFbWFpbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNlbWFpbGApO1xyXG5jb25zdCBpbnB1dFRlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCN0ZWxgKTtcclxuY29uc3QgZm9ybU5ld3NsZXR0ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjZm9ybU5ld3NsZXR0ZXJgKTtcclxuY29uc3QgaW5wdXRFbWFpbE5ld3NsZXR0ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjZW1haWxOZXdzYCk7XHJcblxyXG4vLyBFdmVudG9zXHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGBET01Db250ZW50TG9hZGVkYCwgZXZlbnRMaXN0ZW5lcnMpO1xyXG5cclxuZnVuY3Rpb24gZXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgLy8gQWJyaXIgeSBjZXJyYXIgbmF2XHJcbiAgaGFtYnVyZ3Vlci5hZGRFdmVudExpc3RlbmVyKGBjbGlja2AsIG9wZW5DbG9zZU5hdik7XHJcblxyXG4gIC8vIFZhbGlkYWNpb24gZm9ybXVsYXJpb1xyXG4gIGlucHV0TmFtZS5hZGRFdmVudExpc3RlbmVyKGBpbnB1dGAsIHZhbGlkYXIpO1xyXG4gIGlucHV0RW1haWwuYWRkRXZlbnRMaXN0ZW5lcihgaW5wdXRgLCB2YWxpZGFyKTtcclxuICBpbnB1dFRlbC5hZGRFdmVudExpc3RlbmVyKGBpbnB1dGAsIHZhbGlkYXIpO1xyXG4gIGlucHV0RW1haWxOZXdzbGV0dGVyLmFkZEV2ZW50TGlzdGVuZXIoYGlucHV0YCwgdmFsaWRhcik7XHJcbiAgZm9ybUhlYWRlci5hZGRFdmVudExpc3RlbmVyKGBzdWJtaXRgLCBzZW5kRW1haWwpO1xyXG4gIGZvcm1OZXdzbGV0dGVyLmFkZEV2ZW50TGlzdGVuZXIoYHN1Ym1pdGAsIHNlbmRFbWFpbCk7XHJcbn1cclxuXHJcbi8vIEZ1bmNpb25lc1xyXG5cclxuLyoqXHJcbiAqIExhIGZ1bmNpw7NuIGBvcGVuQ2xvc2VOYXZgIGFjdGl2YSBsYSBjbGFzZSBgbmF2LS1hY3Rpdm9gIGVuIGVsIGVsZW1lbnRvIGBuYXZgIHlcclxuICBsbGFtYSBhIGxhIGZ1bmNpw7NuIGBjbG9zZU5hdk9uQ2xpY2tgIHBhc2FuZG8gZWwgZWxlbWVudG8gYG5hdmAgY29tbyBhcmd1bWVudG8uXHJcbiAqL1xyXG5mdW5jdGlvbiBvcGVuQ2xvc2VOYXYoKSB7XHJcbiAgY29uc3QgbmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLm5hdmApO1xyXG5cclxuICBuYXYuY2xhc3NMaXN0LnRvZ2dsZShgbmF2LS1hY3Rpdm9gKTtcclxuXHJcbiAgY2xvc2VOYXZPbkNsaWNrKG5hdik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBsYSBmdW5jacOzbiBgY2xvc2VOYXZPbkNsaWNrYCBzZSB1c2EgcGFyYSBjZXJyYXIgbGEgbmF2ZWdhY2nDs24gY3VhbmRvIHNlIGxlIGRhIGNsaWNrIGEgdW4gbGluayBvIGN1YW5kb1xyXG4gKiBvY3VycmUgdW4gY2xpY2sgZnVlcmEgZGVsIG1lbsO6LlxyXG4gKiBAcGFyYW0gbmF2IC0gRWwgcGFyw6FtZXRybyBgbmF2YCBlcyB1bmEgcmVmZXJlbmNpYSBhbCBlbGVtZW50byBkZSBuYXYgZW4gZWwgZG9jdW1lbnRvIEhUTUxcclxuICovXHJcbmZ1bmN0aW9uIGNsb3NlTmF2T25DbGljayhuYXYpIHtcclxuICBjb25zdCBuYXZMaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC5uYXZfX2xpbmtgKTtcclxuXHJcbiAgbmF2TGlua3MuZm9yRWFjaCgoZWFjaExpbmssIGluZGV4KSA9PiB7XHJcbiAgICBlYWNoTGluay5hZGRFdmVudExpc3RlbmVyKGBjbGlja2AsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgIC8vIFNjcm9sbCBhbCBkYXIgY2xpY2sgZW4gdW4gZWxlbWVudG9cclxuICAgICAgY29uc3Qgc2VjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZS50YXJnZXQuYXR0cmlidXRlcy5ocmVmLnZhbHVlKTtcclxuICAgICAgc2VjdGlvbi5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiBgc21vb3RoYCB9KTtcclxuXHJcbiAgICAgIC8vIENlcnJhciBlbCBtZW51IHNpIHNlIGxlIGRhIGNsaWNrIGEgdW4gZW5sYWNlXHJcbiAgICAgIGNvbnN0IGFuY2hvciA9IGBBYDtcclxuICAgICAgaWYgKGUudGFyZ2V0LnRhZ05hbWUgPT09IGFuY2hvcikge1xyXG4gICAgICAgIG5hdi5jbGFzc0xpc3QucmVtb3ZlKGBuYXYtLWFjdGl2b2ApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gRWplY3V0YSBlbCBldmVudG8gYGNsaWNrYCBlbiBsYSB2ZW50YW5hIHdpbmRvdyBkZWwgbmF2ZWdhZG9yXHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgLy8gT2J0ZW5lciBlbCBlbGVtZW50byBwYWRyZSBkZWwgZWxlbWVudG8gZW4gZWwgcXVlIHNlIGhpem8gY2xpYy5cclxuICAgIGNvbnN0IHJlZmVyZW5jaWEgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50O1xyXG5cclxuICAgIC8qIDEuIENvbXByb2JhciBzaSBlbCBlbGVtZW50byBuYXYgdGllbmUgbGEgY2xhc2UgJ25hdi0tYWN0aXZvJy5cclxuICAgICAgIDIuIENvbXByb2JhciBzaSBlbCBlbGVtZW50byBwYWRyZSBkZWwgZWxlbWVudG8gZW4gZWwgcXVlIHNlIGhpem8gY2xpYyBubyBlcyBpZ3VhbCBhbCBlbGVtZW50byBjb24gbGEgY2xhc2UgJ2hhbWJ1cmd1ZXInLlxyXG4gICAgICAgU2kgdG9kYXMgbGFzIGNvbmRpY2lvbmVzIHNlIGN1bXBsZW4sIGFsdGVybmFyIGxhIHByZXNlbmNpYSBkZSBsYSBjbGFzZSAnbmF2LS1hY3Rpdm8nIGVuIGVsIGVsZW1lbnRvICduYXYnLlxyXG4gICAgKi9cclxuICAgIGlmIChuYXYuY2xhc3NMaXN0LmNvbnRhaW5zKGBuYXYtLWFjdGl2b2ApICYmIHJlZmVyZW5jaWEgIT09IGhhbWJ1cmd1ZXIpIHtcclxuICAgICAgbmF2LmNsYXNzTGlzdC5yZW1vdmUoYG5hdi0tYWN0aXZvYCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMYSBmdW5jacOzbiBgdmFsaWRhdGVgIHNlIHVzYSBwYXJhIHZhbGlkYXIgbG9zIGNhbXBvcyBkZSBlbnRyYWRhIGRlbCBmb3JtdWxhcmlvLCBpbmNsdXllbmRvIGxhIGNvbXByb2JhY2nDs24gZGUgY2FtcG9zIHZhY8Otb3MsXHJcbiAqIHZhbGlkYXIgZGlyZWNjaW9uZXMgZGUgY29ycmVvIGVsZWN0csOzbmljbywgeSB2YWxpZGFyIG7Dum1lcm9zIGRlIHRlbMOpZm9uby5cclxuICogQHBhcmFtIGUgLSBFbCBwYXLDoW1ldHJvIGBlYCBlcyB1biBvYmpldG8gZXZlbnRvIHF1ZSBzZSBwYXNhIGEgbGEgZnVuY2nDs24gYHZhbGlkYXRlYC5cclxuICogUmVwcmVzZW50YSBlbCBldmVudG8gcXVlIGFjdGl2YSBsYSBmdW5jacOzbiwgY29tbyB1biBjbGljIGVuIHVuIGJvdMOzbiBvIGVsIGVudsOtbyBkZSB1biBmb3JtdWxhcmlvLlxyXG4gKiBAcmV0dXJucyBuYWRhLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhcihlKSB7XHJcbiAgY29uc3QgZW1wdHkgPSBgYDtcclxuICBjb25zdCBpbnB1dCA9IGUudGFyZ2V0O1xyXG4gIGNvbnN0IHJlZmVyZW5jZSA9IGlucHV0LnBhcmVudEVsZW1lbnQ7XHJcbiAgY29uc3QgZmllbGRJZCA9IGlucHV0LmlkO1xyXG4gIGNvbnN0IGZpZWxkTmFtZSA9IGlucHV0Lm5hbWU7XHJcbiAgY29uc3QgZmllbGRWYWx1ZSA9IGlucHV0LnZhbHVlLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAvLyBBbGVydGEgc2kgdW4gZmllbGQgZXN0w6EgdmFjaW9cclxuICBpZiAoZmllbGRWYWx1ZSA9PT0gZW1wdHkgJiYgZmllbGRJZCAhPT0gYGVtYWlsTmV3c2ApIHtcclxuICAgIHNob3dBbGVydChgRWwgJHtmaWVsZE5hbWV9IGVzIG9ibGlnYXRvcmlvYCwgcmVmZXJlbmNlKTtcclxuICAgIGVtYWlsW2ZpZWxkTmFtZV0gPSBgYDtcclxuICAgIGNoZWNrRW1haWwoKTtcclxuXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICAvLyBWYWxpZGFyIGVsIGVtYWlsXHJcbiAgaWYgKGZpZWxkSWQgPT09IGBlbWFpbGAgJiYgIWlzVmFsaWRFbWFpbChmaWVsZFZhbHVlKSkge1xyXG4gICAgc2hvd0FsZXJ0KGBFbCBlbWFpbCBlcyBpbnbDoWxpZG9gLCByZWZlcmVuY2UpO1xyXG4gICAgZW1haWxbZmllbGROYW1lXSA9IGBgO1xyXG4gICAgY2hlY2tFbWFpbCgpO1xyXG5cclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIC8vIFZhbGlkYXIgZWwgdGVsZWZvbm9cclxuICBpZiAoZmllbGRJZCA9PT0gYHRlbGVmb25vYCAmJiAhaXNWYWxpZFRlbChmaWVsZFZhbHVlKSkge1xyXG4gICAgc2hvd0FsZXJ0KGBFbCB0ZWzDqWZvbm8gZXMgaW52w6FsaWRvYCwgcmVmZXJlbmNlKTtcclxuICAgIGVtYWlsW2ZpZWxkTmFtZV0gPSBgYDtcclxuICAgIGNoZWNrRW1haWwoKTtcclxuXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBpZiAoZmllbGRJZCA9PT0gYGVtYWlsTmV3c2AgJiYgIWlzVmFsaWRFbWFpbChmaWVsZFZhbHVlKSkge1xyXG4gICAgc2hvd0FsZXJ0KGBFbCBlbWFpbCBlcyBpbnZhbGlkb2AsIHJlZmVyZW5jZSk7XHJcbiAgICBlbWFpbE5ld3NsZXR0ZXJbZmllbGROYW1lXSA9IGBgO1xyXG4gICAgY2hlY2tFbWFpbE5ld3NsZXR0ZXIoKTtcclxuXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBjbGVhbkFsZXJ0KHJlZmVyZW5jZSk7XHJcblxyXG4gIC8vIExsZW5hciBsb3Mgb2JqZXRvcyBgRW1haWxgIHkgYEVtYWlsTmV3c2xldHRlcmBcclxuICBmaWxsT2JqZWN0cyhyZWZlcmVuY2UsIGZpZWxkTmFtZSwgZmllbGRWYWx1ZSk7XHJcblxyXG4gIC8vIFJldmlzYXIgbG9zIG9iamV0b3MgYEVtYWlsYCB5IGBFbWFpbE5ld3NsZXR0ZXJgXHJcbiAgY2hlY2tFbWFpbCgpO1xyXG4gIGNoZWNrRW1haWxOZXdzbGV0dGVyKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMYSBmdW5jacOzbiBgc2hvd0FsZXJ0YCBtdWVzdHJhIHVuIG1lbnNhamUgZGUgZXJyb3IgZW4gdW4gZWxlbWVudG8gZGUgcmVmZXJlbmNpYSBlc3BlY2lmaWNvLlxyXG4gKiBAcGFyYW0gbWVuc2FqZSAtIEVsIHBhcsOhbWV0cm8gXCJtZW5zYWplXCIgZXMgdW4gc3RyaW5nIHF1ZSByZXByZXNlbnRhIGVsIG1lbnNhamUgZGUgZXJyb3IgcXVlIHNlIG1vc3RyYXLDoSBlbiBsYSBhbGVydGEuXHJcbiAqIEBwYXJhbSByZWZlcmVuY2UgLSBFbCBwYXLDoW1ldHJvIGByZWZlcmVuY2VgIGVzIGxhIHJlZmVyZW5jaWEgZGVsIGVsZW1lbnRvIGRvbmRlIHNlIG1vc3RyYXLDoSBsYSBhbGVydGFcclxuICogU2UgZXNwZXJhIHF1ZSBzZWEgdW4gZWxlbWVudG8gRE9NLlxyXG4gKi9cclxuZnVuY3Rpb24gc2hvd0FsZXJ0KG1lbnNhamUsIHJlZmVyZW5jZSkge1xyXG4gIGNsZWFuQWxlcnQocmVmZXJlbmNlKTtcclxuXHJcbiAgLy8gR2VuZXJhciBsYXMgYWxlcnRhc1xyXG4gIGNvbnN0IGVycm9yID0gcmVmZXJlbmNlLnF1ZXJ5U2VsZWN0b3IoYC5mb3JtX19maWVsZGApO1xyXG5cclxuICBlcnJvci5jbGFzc0xpc3QuYWRkKGBmb3JtX19maWVsZC0tZXJyb3JgKTtcclxuICBlcnJvci5wbGFjZWhvbGRlciA9IG1lbnNhamU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBsYSBmdW5jacOzbiBjbGVhbkFsZXJ0IGVsaW1pbmEgbGEgY2xhc2UgZGUgZXJyb3IgZGUgdW4gY2FtcG8gZGUgZm9ybXVsYXJpbyB5IHJlaW5pY2lhIGVsIHRleHRvIGRlbCBwbGFjZWhvbGRlci5cclxuICogQHBhcmFtIHJlZmVyZW5jZSAtIEVsIHBhcsOhbWV0cm8gYHJlZmVyZW5jZWAgZXMgZWwgZWxlbWVudG8gcXVlIGNvbnRpZW5lIGxhIGFsZXJ0YS4gU2UgdXRpbGl6YSBwYXJhXHJcbiAqIGVuY29udHJhciBlbCBlbGVtZW50byBkZSBhbGVydGEgZGVudHJvIGRlIGxvcyBoaWpvcy5cclxuICovXHJcbmZ1bmN0aW9uIGNsZWFuQWxlcnQocmVmZXJlbmNlKSB7XHJcbiAgLy8gQ29tcHJvYmFyIHNpIGV4aXN0ZSBsYSBhbGVydGFcclxuICBjb25zdCBpc0FjdGl2ZUFsZXJ0ID0gcmVmZXJlbmNlLnF1ZXJ5U2VsZWN0b3IoYC5mb3JtX19maWVsZC0tZXJyb3JgKTtcclxuXHJcbiAgaWYgKGlzQWN0aXZlQWxlcnQpIHtcclxuICAgIGlzQWN0aXZlQWxlcnQuY2xhc3NMaXN0LnJlbW92ZShgZm9ybV9fZmllbGQtLWVycm9yYCk7XHJcbiAgICBpc0FjdGl2ZUFsZXJ0LnBsYWNlaG9sZGVyID0gYEluZ3Jlc2EgdHUgJHtpc0FjdGl2ZUFsZXJ0Lm5hbWV9YDtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMYSBmdW5jacOzbiBgaXNWYWxpZEVtYWlsYCByZXZpc2Egc2kgZWwgZW1haWwgcmVjaWJpZG8gZXMgdsOhbGlkbyBkZSBhY3VlcmRvIGEgdW5hIGV4cHJlc2nDs24gcmVndWxhci5cclxuICogQHBhcmFtIGVtYWlsIC0gRWwgcGFyw6FtZXRybyBgZW1haWxgIGVzIHVuIHN0cmluZyBxdWUgcmVwcmVzZW50YSB1bmEgZGlyZWNjacOzbiBkZSBjb3JyZW8gZWxlY3Ryw7NuaWNvLlxyXG4gKiBAcmV0dXJucyAtIFVuIHZhbG9yIGJvb2xlYW5vIHF1ZSBpbmRpY2Egc2kgZWwgY29ycmVvIGVsZWN0csOzbmljbyByZWNpYmlkbyBlcyB2w6FsaWRvIG8gbm8uXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1ZhbGlkRW1haWwoZW1haWwpIHtcclxuICBjb25zdCByZWdleEVtYWlsID0gL15cXHcrKFsuLV8rXT9cXHcrKSpAXFx3KyhbLi1dP1xcdyspKihcXC5cXHd7MiwxMH0pKyQvO1xyXG4gIGNvbnN0IHJlc3VsdEVtYWlsID0gcmVnZXhFbWFpbC50ZXN0KGVtYWlsKTtcclxuXHJcbiAgcmV0dXJuIHJlc3VsdEVtYWlsO1xyXG59XHJcblxyXG4vKipcclxuICogTGEgZnVuY2nDs24gYGlzVmFsaWRUZWxgIHJldmlzYSBzaSBlbCB0ZWzDqWZvbm8gcmVjaWJpZG8gZXMgdsOhbGlkbyBkZSBhY3VlcmRvIGEgdW5hIGV4cHJlc2nDs24gcmVndWxhci5cclxuICogQHBhcmFtIHRlbCAtIEVsIHBhcsOhbWV0cm8gYHRlbGAgZXMgdW4gc3RyaW5nIHF1ZSByZXByZXNlbnRhIHVuIG7Dum1lcm8gZGUgdGVsw6lmb25vLlxyXG4gKiBAcmV0dXJucyAtIFVuIHZhbG9yIGJvb2xlYW5vIHF1ZSBpbmRpY2Egc2kgZWwgdGVsw6lmb25vIHJlY2liaWRvIGVzIHbDoWxpZG8gbyBuby5cclxuICovXHJcbmZ1bmN0aW9uIGlzVmFsaWRUZWwodGVsKSB7XHJcbiAgY29uc3QgcmVnZXhUZWwgPSAvXihcXCs1MnwwMDUyfDUyKT9bIC1dKlsgLV0qKFswLTldWyAtXSopezEwfS87XHJcbiAgY29uc3QgcmVzdWx0VGVsID0gcmVnZXhUZWwudGVzdCh0ZWwpO1xyXG5cclxuICByZXR1cm4gcmVzdWx0VGVsO1xyXG59XHJcblxyXG4vKipcclxuICogTGEgZnVuY2nDs24gYGZpbGxPYmplY3RzYCByZWxsZW5hIGxvcyBvYmpldG9zIGBlbWFpbGAgeSBgZW1haWxOZXdzbGV0dGVyYCBiYXPDoW5kb3NlIGVuIGVsIGVsZW1lbnRvIHBhZHJlXHJcbiAqIGRlIGxhIHJlZmVyZW5jaWEgZGFkYS5cclxuICogQHBhcmFtIHJlZmVyZW5jZSAtIEVsIHBhcsOhbWV0cm8gcmVmZXJlbmNlIGVzIGVsIGVsZW1lbnRvIHF1ZSBkaXNwYXLDsyBlbCBldmVudG8gbyBlbCBlbGVtZW50b1xyXG4gKiBxdWUgcXVpZXJlcyB1c2FyIGNvbW8gcmVmZXJlbmNpYSBwYXJhIGRldGVybWluYXIgcXXDqSBvYmpldG8gcmVsbGVuYXIuXHJcbiAqIEBwYXJhbSBmaWVsZE5hbWUgLSBFbCBub21icmUgZGVsIGNhbXBvIHF1ZSBzZSBlc3TDoSByZWxsZW5hbmRvIGVuIGxvcyBvYmpldG9zLiBQb3IgZWplbXBsbywgc2kgZWxcclxuICogY2FtcG8gZXMgcGFyYSBsYSBkaXJlY2Npw7NuIGRlIGNvcnJlbyBlbGVjdHLDs25pY28sIGVsIGZpZWxkTmFtZSBzZXLDrWEgXCJlbWFpbFwiLlxyXG4gKiBAcGFyYW0gZmllbGRWYWx1ZSAtIEVsIHBhcsOhbWV0cm8gYGZpZWxkVmFsdWVgIGVzIGVsIHZhbG9yIHF1ZSBkZWJlIGFzaWduYXJzZSBhbCBjYW1wbyBlc3BlY2lmaWNhZG8gZW4gbG9zIG9iamV0b3MgXHJcbiAqIEVtYWlsYCB5IGBFbWFpbE5ld3NsZXR0ZXJgLlxyXG4gKi9cclxuZnVuY3Rpb24gZmlsbE9iamVjdHMocmVmZXJlbmNlLCBmaWVsZE5hbWUsIGZpZWxkVmFsdWUpIHtcclxuICAvLyBMbGVuYXIgbG9zIG9iamV0b3MgYEVtYWlsYCB5IGBFbWFpbE5ld3NsZXR0ZXJgXHJcbiAgaWYgKHJlZmVyZW5jZS5wYXJlbnRFbGVtZW50ID09PSBmb3JtSGVhZGVyKSB7XHJcbiAgICBlbWFpbFtmaWVsZE5hbWVdID0gZmllbGRWYWx1ZTtcclxuICB9XHJcblxyXG4gIGlmIChyZWZlcmVuY2UucGFyZW50RWxlbWVudCA9PT0gZm9ybU5ld3NsZXR0ZXIpIHtcclxuICAgIGVtYWlsTmV3c2xldHRlcltmaWVsZE5hbWVdID0gZmllbGRWYWx1ZTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMYSBmdW5jacOzbiBjb21wcnVlYmEgc2kgYWxnw7puIHZhbG9yIGRlbCBvYmpldG8gZW1haWwgZXN0w6EgdmFjw61vIHkgZGVzYWN0aXZhIGVsIGJvdMOzbiBkZSBlbnbDrW8gc2kgZXMgYXPDrS5cclxuICogQHJldHVybiBOYWRhLlxyXG4gKi9cclxuZnVuY3Rpb24gY2hlY2tFbWFpbCgpIHtcclxuICBjb25zdCBidG5TdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYnRuU3VibWl0YCk7XHJcblxyXG4gIGlmIChPYmplY3QudmFsdWVzKGVtYWlsKS5pbmNsdWRlcyhgYCkpIHtcclxuICAgIGJ0blN1Ym1pdC5kaXNhYmxlZCA9IHRydWU7XHJcblxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgYnRuU3VibWl0LmRpc2FibGVkID0gZmFsc2U7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMYSBmdW5jacOzbiBjb21wcnVlYmEgc2kgYWxnw7puIHZhbG9yIGRlbCBvYmpldG8gZW1haWxOZXdzbGV0dGVyIGVzdMOhIHZhY8OtbyB5IGRlc2FjdGl2YSBlbCBib3TDs25cclxuICogYnRuU3Vic2NyaWJlIHNpIGVzIGFzw60uXHJcbiAqIEByZXR1cm4gTmFkYS5cclxuICovXHJcbmZ1bmN0aW9uIGNoZWNrRW1haWxOZXdzbGV0dGVyKCkge1xyXG4gIGNvbnN0IGJ0blN1YnNjcmliZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNidG5TdWJzY3JpYmVgKTtcclxuXHJcbiAgaWYgKE9iamVjdC52YWx1ZXMoZW1haWxOZXdzbGV0dGVyKS5pbmNsdWRlcyhgYCkpIHtcclxuICAgIGJ0blN1YnNjcmliZS5kaXNhYmxlZCA9IHRydWU7XHJcblxyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBidG5TdWJzY3JpYmUuZGlzYWJsZWQgPSBmYWxzZTtcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBMYSBmdW5jacOzbiBgc2VuZEVtYWlsYCBlcyB1bmEgZnVuY2nDs24gamF2YXNjcmlwdCBxdWUgbWFuZWphIGxvcyBlbnbDrW9zIGRlIGZvcm11bGFyaW9zLCBtdWVzdHJhIHVuXHJcbiAqIFNwaW5uZXIsIHJlaW5pY2lhIGVsIGZvcm11bGFyaW8sIHkgbXVlc3RyYSB1biBtZW5zYWplIGRlIMOpeGl0byBkZXNwdcOpcyBkZSB1biBjaWVydG8gcmV0cmFzby5cclxuICogQHBhcmFtIGUgLSBFbCBwYXLDoW1ldHJvIGBlYCBlcyB1biBvYmpldG8gZGUgZXZlbnRvIHF1ZSBzZSBwYXNhIGEgbGEgZnVuY2nDs24gYHNlbmRFbWFpbGAuXHJcbiAqIE5vcm1hbG1lbnRlIHNlIGRlc2VuY2FkZW5hIHBvciB1biByZWNlcHRvciBkZSBldmVudG9zLCBjb21vIGVsIGVudsOtbyBkZSB1biBmb3JtdWxhcmlvIG8gbGEgcHVsc2FjacOzbiBkZSB1biBib3TDs24uIEVsIG9iamV0b1xyXG4gKiBjb250aWVuZSBpbmZvcm1hY2nDs24gc29icmUgZWwgZXZlbnRvIHF1ZSBzZSBoYSBwcm9kdWNpZG8sIGNvbW8gZWwgZWxlbWVudG8gZGUgZGVzdGlubyBxdWUgZGVzZW5jYWRlbsOzIGVsIGV2ZW50by4uXHJcbiAqIEByZXR1cm5zIE5hZGEuXHJcbiAqL1xyXG5mdW5jdGlvbiBzZW5kRW1haWwoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgaW5wdXQgPSBlLnRhcmdldDtcclxuXHJcbiAgaWYgKGlucHV0ID09PSBmb3JtSGVhZGVyKSB7XHJcbiAgICBjb25zdCBzcGlubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3NwaW5uZXJgKTtcclxuXHJcbiAgICBzcGlubmVyLmNsYXNzTGlzdC5hZGQoYGZvcm1fX3NwaW5uZXItLWFjdGl2b2ApO1xyXG4gICAgc3Bpbm5lci5jbGFzc0xpc3QucmVtb3ZlKGBmb3JtX19zcGlubmVyYCk7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHNwaW5uZXIuY2xhc3NMaXN0LnJlbW92ZShgZm9ybV9fc3Bpbm5lci0tYWN0aXZvYCk7XHJcbiAgICAgIHNwaW5uZXIuY2xhc3NMaXN0LmFkZChgZm9ybV9fc3Bpbm5lcmApO1xyXG5cclxuICAgICAgLy8gUmVpbmljaWFyIGVsIGZvcm11bGFyaW9cclxuICAgICAgcmVzZXRGb3JtKGlucHV0KTtcclxuXHJcbiAgICAgIC8vIENyZWFyIGFsZXJ0YSBkZSBleGl0b1xyXG4gICAgICBjb25zdCBhbGVydGFFeGl0byA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYFBgKTtcclxuICAgICAgYWxlcnRhRXhpdG8uY2xhc3NMaXN0LmFkZChgZm9ybV9fZXhpdG9gKTtcclxuICAgICAgYWxlcnRhRXhpdG8udGV4dENvbnRlbnQgPSBcIk1lbnNhamUgZW52w61hZG8gZXhpdG9zYW1lbnRlXCI7XHJcblxyXG4gICAgICBmb3JtSGVhZGVyLmFwcGVuZENoaWxkKGFsZXJ0YUV4aXRvKTtcclxuXHJcbiAgICAgIC8vIEVsaW1pbmFyIGxhIGFsZXJ0YSBkZXNwdWVzIGRlIG1vc3RyYXJsYVxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBhbGVydGFFeGl0by5yZW1vdmUoKTtcclxuICAgICAgfSwgMjAwMCk7XHJcbiAgICB9LCAzMDAwKTtcclxuXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBpZiAoaW5wdXQgPT09IGZvcm1OZXdzbGV0dGVyKSB7XHJcbiAgICBjb25zdCBzcGlubmVyTmV3cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNzcGlubmVyTmV3c2ApO1xyXG5cclxuICAgIHNwaW5uZXJOZXdzLmNsYXNzTGlzdC5hZGQoYGZvcm1fX3NwaW5uZXItLWFjdGl2b2ApO1xyXG4gICAgc3Bpbm5lck5ld3MuY2xhc3NMaXN0LnJlbW92ZShgZm9ybV9fc3Bpbm5lcmApO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICBzcGlubmVyTmV3cy5jbGFzc0xpc3QucmVtb3ZlKGBmb3JtX19zcGlubmVyLS1hY3Rpdm9gKTtcclxuICAgICAgc3Bpbm5lck5ld3MuY2xhc3NMaXN0LmFkZChgZm9ybV9fc3Bpbm5lcmApO1xyXG5cclxuICAgICAgLy8gUmVpbmljaWFyIGVsIGZvcm11bGFyaW9cclxuICAgICAgcmVzZXRGb3JtKGlucHV0KTtcclxuXHJcbiAgICAgIC8vIENyZWFyIGFsZXJ0YSBkZSBleGl0b1xyXG4gICAgICBjb25zdCBhbGVydGFFeGl0byA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYFBgKTtcclxuICAgICAgYWxlcnRhRXhpdG8uY2xhc3NMaXN0LmFkZChgZm9ybV9fZXhpdG9gKTtcclxuICAgICAgYWxlcnRhRXhpdG8uY2xhc3NMaXN0LmFkZChgZm9ybV9fZXhpdG8tLW5ld3NsZXR0ZXJgKTtcclxuICAgICAgYWxlcnRhRXhpdG8udGV4dENvbnRlbnQgPSBgR3JhY2lhcyBwb3Igc3VzY3JpYmlydGVgO1xyXG5cclxuICAgICAgZm9ybU5ld3NsZXR0ZXIuYXBwZW5kQ2hpbGQoYWxlcnRhRXhpdG8pO1xyXG5cclxuICAgICAgLy8gRWxpbWluYXIgbGEgYWxlcnRhIGRlc3B1ZXMgZGUgbW9zdHJhcmxhXHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGFsZXJ0YUV4aXRvLnJlbW92ZSgpO1xyXG4gICAgICB9LCAyMDAwKTtcclxuICAgIH0sIDMwMDApO1xyXG5cclxuICAgIHJldHVybjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMYSBmdW5jaW9uYHJlc2V0Rm9ybWAgcmVpbmljaWEgbG9zIHZhbG9yZXMgZGUgbG9zIGlucHV0IGVuIGRvcyBmb3JtdWxhcmlvcyBkaWZlcmVudGVzIHkgY29tcHJ1ZWJhIGxhXHJcbiB2YWxpZGV6IGRlIGxhcyBkaXJlY2Npb25lcyBkZSBjb3JyZW8gZWxlY3Ryw7NuaWNvLiBcclxuICogQHBhcmFtIGlucHV0IC0gRWwgcGFyw6FtZXRybyBpbnB1dCBzZSB1c2EgcGFyYSBkZXRlcm1pbmFyIHF1w6kgZm9ybXVsYXJpbyByZWluaWNpYXIuIFB1ZWRlIHNlclxyXG4gKiBmb3JtSGVhZGVyIG8gZm9ybU5ld3NsZXR0ZXIuXHJcbiAqIEByZXR1cm5zIG5hZGEuXHJcbiAqL1xyXG5mdW5jdGlvbiByZXNldEZvcm0oaW5wdXQpIHtcclxuICBpZiAoaW5wdXQgPT09IGZvcm1IZWFkZXIpIHtcclxuICAgIC8vIFJlaW5pY2lhciBvYmpldG9zXHJcbiAgICBlbWFpbC5ub21icmUgPSBgYDtcclxuICAgIGVtYWlsLmVtYWlsID0gYGA7XHJcbiAgICBlbWFpbC50ZWxlZm9ubyA9IGBgO1xyXG5cclxuICAgIC8vIFJlaW5pY2lhciBsb3MgZm9ybXVsYXJpb3NcclxuICAgIGZvcm1IZWFkZXIucmVzZXQoKTtcclxuXHJcbiAgICAvLyBSZXZpc2FyIGVsIG9iamV0b1xyXG4gICAgY2hlY2tFbWFpbCgpO1xyXG5cclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGlmIChpbnB1dCA9PT0gZm9ybU5ld3NsZXR0ZXIpIHtcclxuICAgIC8vIFJlaW5pY2lhciBlbCBvYmpldG9cclxuICAgIGVtYWlsTmV3c2xldHRlci5lbWFpbCA9IGBgO1xyXG5cclxuICAgIC8vIFJlaW5pY2lhciBlbCBmb3JtdWxhcmlvXHJcbiAgICBmb3JtTmV3c2xldHRlci5yZXNldCgpO1xyXG5cclxuICAgIC8vIFJldmlzYXIgZWwgb2JqZXRvIGVtYWlsbmV3c2xldHRlclxyXG4gICAgY2hlY2tFbWFpbE5ld3NsZXR0ZXIoKTtcclxuXHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG59XHJcbiJdfQ==
